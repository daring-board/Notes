.. _causal:

.. toctree::
  :maxdepth: 4


因果関係
==============

因果関係とは、
 2つの事象に対して、一方が原因でもう一方がその結果であるという関係である。

.. attention:
 | 因果関係と相関関係の関係は相関関係は因果関係を含まないが
 | 因果関係は相関関係を包含する。
 |

因果関係を推定する手法
-------------------------------

差分の差分法(DID: Difference in differences)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

DID [#]_ とは、

 | 観測データによって実験的な研究を模倣するための統計手法である。
 | 従属変数における説明変数の効果を、各カテゴリ群における従属変数の
 | 時間を通じた平均的な変化とあるカテゴリ群における時間を通じた変化と
 | 比較することで計算する。

DIDで用いるモデル
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. math::
  y_{ist} = \gamma_{s} + \lambda_{t} + \delta D_{st} + \epsilon_{ist}

.. math::
  t &:& 時刻 \\
  s &:& 説明変数 \\
  i &:& 個体ID \\
  y_{ist} &:& 個体iにs, tを所与したときの従属変数の観測値 \\
  \gamma_{s} &:& sの垂直的な切片 \\
  \lambda_{t} &:& tの垂直的な切片 \\
  \delta &:& 説明変数における処置効果 \\
  D_{st} &:& 処置状態を表すダミー変数 \\
  \epsilon_{ist} &:& 誤差項 \\

算出方法
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

| 説明変数を :math:`s \in \{1, 2\}` とし、説明変数の各値に対して、個体数を :math:`n` とする。
| このとき、 時刻 :math:`t` において、従属変数の観測値の平均を以下とする。

.. math::
  \overline{y}_{st} = \frac{1}{n}\sum_{i=1}^{n}y_{ist}

| 説明変数 :math:`s` の各カテゴリ群に対して、 :math:`\overline{y}_{1t}, \overline{y}_{2t}` を得る。
| 更に、時刻 :math:`t+1` まで進めたとき、説明変数 :math:`s` に対して、 :math:`\overline{y}_{1t+1}, \overline{y}_{2t+1}` を得る。
| このとき、以下を求める事によって説明変数 :math:`s` が従属変数に与える効果を推定する。

.. math::
  \hat{\delta} &=& (\overline{y}_{1t} - \overline{y}_{1t+1}) - (\overline{y}_{2t} - \overline{y}_{2t+1}) \\
  &=& \delta(\overline{D}_{11} - \overline{D}_{12}) + \delta(\overline{D}_{22} - \overline{D}_{21}) + \overline{\epsilon}_{11} - \overline{\epsilon}_{12} + \overline{\epsilon}_{22} - \overline{\epsilon}_{21}

算出結果の解釈
~~~~~~~~~~~~~~~~~~~~~~~~~~~

| 説明変数を :math:`s \in \{1, 2\}` の分類に対して、以下とする。
| :math:`s=1` のとき、処置Aを行う。
| :math:`s=2` のとき、処置Aを行わない。
| このとき、時刻 :math:`t` から時刻 :math:`t+1` の間に処置Aを行うグループ( :math:`s=1` )に対して、
| 従属変数の観測された差分 :math:`(\overline{y}_{1t} - \overline{y}_{1t+1})` と
| 時刻 :math:`t` から時刻 :math:`t+1` の間に処置Aを行わないグループ( :math:`s=2` )に対して、
| 従属変数の観測された差分 :math:`(\overline{y}_{2t} - \overline{y}_{2t+1})` を比較している。
| DIDによって算出される値は、上記の2つのグループの変化量の比較結果に有意な差がみられるかどうかを検討するための値である言える。

.. [#] `差分の差分法 <https://ja.wikipedia.org/wiki/差分の差分法>`_
