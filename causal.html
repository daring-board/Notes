
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>因果関係 &#8212; Notes  ドキュメント</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="主成分分析" href="pca.html" />
    <link rel="prev" title="相関関係" href="correlation.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Notes  ドキュメント</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="correlation.html" title="相関関係"
             accesskey="P">前へ</a> |
          <a href="pca.html" title="主成分分析"
             accesskey="N">次へ</a> |
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound" id="causal">
</div>
<div class="section" id="id1">
<h1>因果関係<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<dl class="simple">
<dt>因果関係とは、</dt><dd><p>2つの事象に対して、一方が原因でもう一方がその結果であるという関係である。</p>
</dd>
</dl>
<p>ここでは、因果関係を推定する手法について説明する。</p>
<div class="section" id="id2">
<h2>差分の差分法<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>差分の差分法(DID: Difference in differences) <a class="footnote-reference brackets" href="#id12" id="id3">1</a> とは、</p>
<blockquote>
<div><div class="line-block">
<div class="line">観測データによって実験的な研究を模倣するための統計手法である。</div>
<div class="line">目的変数における説明変数の効果を、各カテゴリ群における従属変数の</div>
<div class="line">時間を通じた平均的な変化とあるカテゴリ群における時間を通じた変化と</div>
<div class="line">比較することで計算する。</div>
</div>
</div></blockquote>
<div class="section" id="did">
<h3>DIDで用いるモデル<a class="headerlink" href="#did" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="math notranslate nohighlight">
\[y_{ist} = \gamma_{s} + \lambda_{t} + \delta D_{st} + \epsilon_{ist}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}t &amp;:&amp; 時刻 \\
s &amp;:&amp; 説明変数 \\
i &amp;:&amp; 個体ID \\
y_{ist} &amp;:&amp; 個体iにs, tを所与したときの目的変数の観測値 \\
\gamma_{s} &amp;:&amp; sの垂直的な切片 \\
\lambda_{t} &amp;:&amp; tの垂直的な切片 \\
\delta &amp;:&amp; 説明変数における処置効果 \\
D_{st} &amp;:&amp; 処置状態を表すダミー変数 \\
\epsilon_{ist} &amp;:&amp; 誤差項 \\\end{split}\]</div>
</div>
<div class="section" id="id4">
<h3>算出方法<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">説明変数を <span class="math notranslate nohighlight">\(s \in \{1, 2\}\)</span> とし、説明変数の各値に対して、個体数を <span class="math notranslate nohighlight">\(n\)</span> とする。</div>
<div class="line">このとき、 時刻 <span class="math notranslate nohighlight">\(t\)</span> において、目的変数の観測値の平均を以下とする。</div>
</div>
<div class="math notranslate nohighlight">
\[\overline{y}_{st} = \frac{1}{n}\sum_{i=1}^{n}y_{ist}\]</div>
<div class="line-block">
<div class="line">説明変数 <span class="math notranslate nohighlight">\(s\)</span> の各カテゴリ群に対して、 <span class="math notranslate nohighlight">\(\overline{y}_{1t}, \overline{y}_{2t}\)</span> を得る。</div>
<div class="line">更に、時刻 <span class="math notranslate nohighlight">\(t+1\)</span> まで進めたとき、説明変数 <span class="math notranslate nohighlight">\(s\)</span> に対して、 <span class="math notranslate nohighlight">\(\overline{y}_{1t+1}, \overline{y}_{2t+1}\)</span> を得る。</div>
<div class="line">このとき、以下を求める事によって説明変数 <span class="math notranslate nohighlight">\(s\)</span> が目的変数に与える効果を推定する。</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{\delta} &amp;=&amp; (\overline{y}_{1t} - \overline{y}_{1t+1}) - (\overline{y}_{2t} - \overline{y}_{2t+1}) \\
&amp;=&amp; \delta(\overline{D}_{11} - \overline{D}_{12}) + \delta(\overline{D}_{22} - \overline{D}_{21}) + \overline{\epsilon}_{11} - \overline{\epsilon}_{12} + \overline{\epsilon}_{22} - \overline{\epsilon}_{21}\end{split}\]</div>
</div>
<div class="section" id="id5">
<h3>算出結果の解釈<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">説明変数を <span class="math notranslate nohighlight">\(s \in \{1, 2\}\)</span> の分類に対して、以下とする。</div>
<div class="line"><span class="math notranslate nohighlight">\(s=1\)</span> のとき、処置Aを行う。</div>
<div class="line"><span class="math notranslate nohighlight">\(s=2\)</span> のとき、処置Aを行わない。</div>
<div class="line">このとき、時刻 <span class="math notranslate nohighlight">\(t\)</span> から時刻 <span class="math notranslate nohighlight">\(t+1\)</span> の間に処置Aを行うグループ( <span class="math notranslate nohighlight">\(s=1\)</span> )に対して、</div>
<div class="line">目的変数の観測された差分 <span class="math notranslate nohighlight">\((\overline{y}_{1t} - \overline{y}_{1t+1})\)</span> と</div>
<div class="line">時刻 <span class="math notranslate nohighlight">\(t\)</span> から時刻 <span class="math notranslate nohighlight">\(t+1\)</span> の間に処置Aを行わないグループ( <span class="math notranslate nohighlight">\(s=2\)</span> )に対して、</div>
<div class="line">目的変数の観測された差分 <span class="math notranslate nohighlight">\((\overline{y}_{2t} - \overline{y}_{2t+1})\)</span> を比較している。</div>
<div class="line">DIDによって算出される値は、上記の2つのグループの変化量の比較結果に有意な差がみられるかどうかを検討するための値である言える。</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>傾向スコアによる手法<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>差分の差分法は対象集団に対して、実験が行えることを前提とした実験的手法である。
一方、実社会では実験的な手法は行えず、現行あるデータを用いることしかできない場合が多い。
こういった状況で、手元にあるデータを使って因果関係(因果効果)を探るための手法を説明する。</p>
<p>傾向スコアを説明する上での要素を整理する。</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i &amp;:&amp; データiの目的変数 \\
x_i &amp;:&amp; データiの説明変数 \\
c_i &amp;:&amp; データiに関する共変量ベクトル \\\end{split}\]</div>
<div class="line-block">
<div class="line">共変量ベクトルは説明変数にも目的変数にも寄与しており、それらの観測値に影響していると仮定する。</div>
<div class="line">傾向スコアの前に因果効果について説明する。</div>
<div class="line">因果効果とは、説明変数が目的変数に対して与える影響である。</div>
<div class="line">データiに対して説明変数 <span class="math notranslate nohighlight">\(x_{t-1i}\)</span> から <span class="math notranslate nohighlight">\(x_{ti}\)</span> に変化したときの目的変数の変化量 <span class="math notranslate nohighlight">\(y_{ti} - y_{t-1i}\)</span> を因果効果とする。</div>
</div>
<div class="math notranslate nohighlight">
\[y_{ti} - y_{t-1i} = f(x_{ti}-x_{t-1i}| c_i=c)\]</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">定義文には明記しなかったが、 <span class="math notranslate nohighlight">\(c_i\)</span> は共変量ベクトルで、説明変数にも目的変数にも影響を与えていると</div>
<div class="line">仮定されるような変数群である。因果効果はこの共変量ベクトルが得られている条件下で与えられる値ということに注意しておく必要がある。</div>
</div>
</div>
<div class="section" id="id8">
<h3>傾向スコア <a class="footnote-reference brackets" href="#id14" id="id7">2</a> とは<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>観測した共変量が与えられている条件の下で、説明変数の観測値が
得られる条件付き確率を傾向スコアという。</p>
<div class="math notranslate nohighlight">
\[e_i = prob(x_i=x|c_i=c)\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}e_i &amp;:&amp; 傾向スコア \\
c_i &amp;:&amp; データiに関する共変量ベクトル \\
x_i &amp;:&amp; データiの観測した説明変数 \\\end{split}\]</div>
</div>
</div>
<div class="section" id="id9">
<h2>因果関係の探索<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>因果関係の探索手法として、LiNGAM(Linear non-Gausian acyclic model)を説明する。
その準備として、因果グラフと構造方程式を定義する。</p>
<div class="section" id="id10">
<h3>因果グラフ<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>因果関係は原因と結果という一方向性を持つ構造として表現可能である。
また、因果関係には原因1から結果1、その結果1が原因2となり別の結果2を生み出す連鎖が考えられるが、
元の原因1が発起する原因が結果2であるというような巡回が発生することは不自然である。
この仮定のもと因果関係を表現する方法としてDAG(Directed Acyclic Graph)を使用する。</p>
<dl class="simple">
<dt>因果グラフ(DAG)とは、</dt><dd><p>因果関係の因子をVertexとし、原因と結果の関係にあるVertexの対をEdgeとしたGraph構造である。
また、Edgeには方向が定義され、巡回するパスを持たない。
形式的には以下のように記述される。</p>
</dd>
</dl>
<div class="math notranslate nohighlight">
\[\begin{split}DAG &amp;=&amp; (V, E) \\
V &amp;:&amp; 因子全体の集合 \\
E = V \times V &amp;:&amp; 因果関係の集合 \\\end{split}\]</div>
</div>
<div class="section" id="id11">
<h3>構造方程式<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>LiNGAM
<a class="reference external" href="https://www.slideshare.net/sshimizu2006/sshimizu-mathcooptalk-finalweb">https://www.slideshare.net/sshimizu2006/sshimizu-mathcooptalk-finalweb</a></p>
<dl class="footnote brackets">
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p><a class="reference external" href="https://ja.wikipedia.org/wiki/差分の差分法">差分の差分法</a></p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id7">2</a></span></dt>
<dd><p><a class="reference external" href="http://takehiko-i-hayashi.hatenablog.com/entry/20120427/1335475881">傾向スコア</a></p>
</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>目次</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">序論</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation.html">相関関係</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">因果関係</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">差分の差分法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">傾向スコアによる手法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">因果関係の探索</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pca.html">主成分分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="ica.html">独立成分分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayes.html">ベイズ推論</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_regression.html">線形回帰</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine_learning1.html">機械学習1</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">検索</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="検索" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="correlation.html" title="相関関係"
              >前へ</a> |
            <a href="pca.html" title="主成分分析"
              >次へ</a> |
            <a href="genindex.html" title="総合索引"
              >索引</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/causal.rst.txt"
                rel="nofollow">ソースコードを表示</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, https://www.facebook.com/mahoto.iwasa.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0 で生成しました。
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>